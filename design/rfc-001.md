# Vault

![Architecture](./images/architecture.png)

# Identity

每个人均有唯一的Identity（ID），与此ID相关的数据存储在该ID的Vault中。我们使用[W3C DID](https://www.w3.org/TR/did-core/)作为身份识别与授权管理。

# DID 

我们使用DID描述Vault。相应地，一个Vault的元数据是一个DID Document。如果某人的签名能够通过DID Document的`authentication`验证，那么他可以修改Vault，换句话说，他是Vault的管理员。

## 数据区 

Vault按照Section（区）划分数据，默认数据存储在Primary区。与其他人协助的数据存储在其他区。

### 协助区

每个Vault可以有若干个协作区，其他用户可以向协作区进行读写数据，以实现用户之间的协助。协作区拥有唯一的区号，区号默认为对方的Vault ID或者是Byte Factory的ID。

协作区仍然使用DID Document描述，通过`authentication`验证则能访问其中的数据。

## 数据项 

一个 Vault 中可以存储多个数据项，每个数据项称为一个 Entry。Entry 以 Key-Value 对的形式保存，其 Key 是根据 Value 和一个随机数生成的哈希值，它具有唯一性、切不可预测，其 Valut 可以为任何形式的数据，其内容通常是加密的，对于不敏感的数据也可以以明文保存。

# Vault管理

## 注册

用户注册前需要生成一对公私钥，并将自己的身份信息和公钥安全地发送给托管Vault的Service Provider。Service Provider为用户生成DID和DID Document。Document的`authentication`为该用户的公钥，用于授权签名验证。

Service Provider将托管地址写入Document的`ServiceEndpoint`，并对进行签名，然后返回给用户。
